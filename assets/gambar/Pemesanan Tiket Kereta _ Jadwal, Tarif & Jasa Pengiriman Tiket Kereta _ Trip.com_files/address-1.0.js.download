function ContentScrollLite(t){this._config=$.extend(!0,{scrollBody:null,scrollTarget:null,gap:{top:0,bottom:0},animSpeed:20},t),this.init()}window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return setTimeout(t,1e3/60)},window.cancelAnimationFrame=window.cancelAnimationFrame||window.mozCancelAnimationFrame||function(t){clearTimeout(t)},ContentScrollLite.prototype={constructor:ContentScrollLite,init:function(){this._config.scrollTarget||(this._config.scrollTarget=this._config.target),this._config.scrollBody&&!cQuery.isCDom(this._config.scrollBody)&&(this._config.scrollBody=cQuery(this._config.scrollBody)),cQuery.isCDom(this._config.scrollTarget)||(this._config.scrollTarget=cQuery(this._config.scrollTarget));var t=navigator.appVersion.match(/chrome\/(\d+)/i),e=0;t&&2<=t.length&&(e=parseInt(t[1])),this.ui={body:(cQuery.isCDom(this._config.scrollBody)?this._config.scrollBody[0]:this._config.scrollBody)||(cQuery.browser.isChrome&&e<60?document.body:document.documentElement)}},_findFirstBlock:function(t){var i=null;return cQuery.each(t,function(t,e){"style"!==e.nodeName.toLowerCase()&&(i=e)}),i},getScrollTop:function(){return this.getBodyClientHeight()+this.getBodyScrollTop()},getBodyScrollTop:function(){return this.ui.body.scrollTop},setBodyScrollTop:function(t){t&&(this.ui.body.scrollTop=t)},getBodyClientHeight:function(){return this.ui.body.clientHeight},getBodyScrollHeigth:function(){return this.ui.body.scrollHeight},scrollTop:function(t){t&&(this.ui.body.scrollTop=t)},canScroll:function(){return this.getBodyScrollHeigth()!==this.getBodyClientHeight()},checkScroll:function(t){if(this.canScroll()&&t){var e=this._findFirstBlock(t[0].children);if(e){var i=cQuery(e).offset(),s=i.top+i.height+this._config.gap.bottom,r=s-this.getBodyClientHeight(),n=this._config.scrollTarget.offset(),a=Math.min(r,n.top-this._config.gap.top);this.getScrollTop()<s&&this.startAnim(this.getBodyScrollTop(),a)}}},_requestId:null,startAnim:function(t,e){this.cancelAnim(),this.animInfo={begin:t,end:e,range:e-t,startNum:0,endNum:this._config.animSpeed||20},this.animation()},animation:function(){var t=this;this._requestId=requestAnimationFrame(function(){t.setBodyScrollTop(t.animInfo.begin+t.animInfo.startNum/t.animInfo.endNum*t.animInfo.range),t.animInfo.startNum<t.animInfo.endNum&&(t.animInfo.startNum+=1,t.animation())})},cancelAnim:function(){this._requestId&&(cancelAnimationFrame(this._requestId),this.setBodyScrollTop(this.animInfo.end))}},window.replace=function(){return""},function(_){function t(t,e){this._init(t,e)}function e(t){function e(){var i=this;s.each(function(t,e){t[0]==i?(t.addClass("hot_selected"),r[e].style.display=""):(t.removeClass("hot_selected"),r[e].style.display="none")})}var s=t.find("span"),r=t.find("ul");if(s.length){for(var i=30,n=0,a=s.length;n<a;n++)i+=s[n].offsetWidth;(t=t.find("div").first())[0]&&278<i&&t.css("width",i+"px"),s.bind("mousedown",e),e.apply(s[0])}}function i(t){}var n={name:"address",version:"1.0",init:function(){},uninit:function(){},module:t},a={change:1,userinput:1,enter:1,suggestion:1,filter:1},o="_"+n.name+"_"+n.version;_.extend(t.prototype,{target:null,scrollTarget:null,scrollGap:{top:0,bottom:10},scrollAnimatingSpeed:20,target_get:function(){return this.target},name:null,name_get:function(){return this.name},name_set:function(t){this.name=t,this._checkEnable()},delay:0,source:null,source_get:function(t){return t?t in this.source?_.copy(this.source[t]):(_.error("mod ("+n.name+","+n.version+") source_get","invalid key "+t),null):_.copy(this.source)},source_set:function(t){this.source=t?_.extend(this.source||{},t):null,this._refresh()},jsonpSource:null,jsonpSource_get:function(){return this.jsonpSource},jsonpSource_set:function(t){(this.jsonpSource=t)?(this.source=null,this.jsonpSource=t,_.loader.jsonp(this.jsonpSource,{charset:this.charset,onload:function(t){"function"==_.type(this.jsonpSourceInit)&&(t=this.jsonpSourceInit(t)),this.source_set(t)}.bind(this)})):this.source?this.jsonpSource=null:_.error("mod ("+n.name+","+n.version+") jsonpSource_set","invalid source "+t)},jsonpFilter:null,jsonpFilter_get:function(){return this.jsonpFilter},jsonpFilter_set:function(t){this.jsonpFilter=t},jsonpSourceInit:null,jsonpFilterInit:null,sort:"^0$ ^1$ ^3+$ ^0 ^1 ^3+ 0 1 3+".split(" "),sort_get:function(){return _.copy(this.sort)},sort_set:function(t){this.sort=_.copy(t),this._sortReString=null,this._refresh()},display:{left:0,right:1,suggestion:1,value:1},display_get:function(t){return t?t in this.display?_.copy(this.display[t]):(_.error("mod ("+n.name+","+n.version+") display_get","invalid key "+t),null):_.copy(this.display)},display_set:function(t){t?_.extend(this.display,t):this.display={},this._refresh()},relate:{},relate_get:function(t){return t?t in this.relate?_.copy(this.relate[t]):(_.error("mod ("+n.name+","+n.version+") relate_get","invalid key "+t),null):_.copy(this.relate)},relate_set:function(t){this.relate=t?_.copy(t):{},this._refresh()},message:{suggestion:"从下列城市选择",filterResult:"${val}，按拼音排序",noFilterResult:"对不起，找不到：${val}",sort:[]},message_set:function(t){t?_.extend(this.message,t):this.message={},this._refresh()},message_get:function(t){return t?t in this.message?_.copy(this.message[t]):(_.error("mod ("+n.name+","+n.version+") message_get","invalid key "+t),null):_.copy(this.message)},offset:null,offset_set:function(t){this.offset=t?_.copy(t):null,this._refresh()},offset_get:function(t){return _.copy(this.offset)},minLength:1,isAutoCorrect:!1,isFocusNext:!1,isFilterSelect:!0,keyboard:{up:!0,down:!0,left:!0,right:!0,enter:!0},template:{suggestion:'                <div class="c_address_box">                    <div class="c_address_hd">${message.suggestion}</div>                    <div class="c_address_bd">                        <ol class="c_address_ol">                            {{enum(key) data}}                                <li><span>${key}</span></li>                            {{/enum}}                        </ol>                        {{enum(key,arr) data}}                            <ul class="c_address_ul layoutfix">                                {{each arr}}                                    <li><a data="${data}" href="javascript:void(0);">${display}</a></li>                                {{/each}}                            </ul>                        {{/enum}}                    </div>                </div>            ',suggestionStyle:"                .c_address_box { background-color: #fff; font-size: 12px; width: 290px; }                .c_address_box a { text-decoration: none; }                .c_address_hd { height: 24px; border-color: #2C7ECF; border-style: solid; border-width: 1px 1px 0; background-color: #67A1E2; color:#CEE3FC; line-height: 24px; padding-left: 10px; }                .c_address_hd strong{color:#fff;}                .c_address_bd { border-color: #999999; border-style: solid; border-width: 0 1px 1px; overflow: hidden; padding:10px; }                .c_address_ol { margin:0; padding:0 0 20px; border-bottom: 1px solid #5DA9E2; }                .c_address_ol li { color: #005DAA; cursor: pointer; float: left; height: 20px; line-height: 20px; list-style-type: none; text-align: center; }                .c_address_ol li span { padding:0 8px; white-space:nowrap; display:block; }                .c_address_ol li .hot_selected { display:block; padding:0 7px; background-color: #FFFFFF; border-color: #5DA9E2; border-style: solid; border-width: 1px 1px 0; color: #000000; font-weight: bold; }                .c_address_ul { width: 100%; margin:0; padding: 4px 0 0; }                .c_address_ul li { float: left; height: 24px; overflow: hidden; width: 67px; }                .c_address_ul li a { display: block; height: 22px;  border: 1px solid #FFFFFF; color: #1148A8; line-height: 22px; padding-left: 5px; }                .c_address_ul li a:hover { background-color: #E8F4FF; border: 1px solid #ACCCEF; text-decoration: none; }            ",suggestionInit:e,filter:'                {{if list}}                    <div class="c_address_select">                        <div class="c_address_wrap">                            <div class="c_address_hd">{{if hasResult}}{{tmpl message.filterResult}}{{else}}{{tmpl message.noFilterResult}}{{/if}}</div>                            <div class="c_address_list" style="">                                {{each (i,item) list}}                                    {{if cQuery.type(item)=="string"}}                                        <label>${item}</label>                                    {{else}}                                        <a href="javascript:void(0);" data="${data}" style="display: block;"><span>${left}</span>${right}</a>                                    {{/if}}                                {{/each}}                            </div>                            {{if page.max>-1}}                                <div class="c_address_pagebreak" style="display: block;">                                    {{if page.current>0}}                                        <a href="javascript:void(0);" page="${page.current-1}">&lt;-</a>                                    {{/if}}                                    {{if page.current<2}}                                        {{loop(index) Math.min(5,page.max+1)}}                                            <a href="javascript:void(0);"{{if page.current==index}} class="address_current"{{/if}} page="${index}">${index+1}</a>                                        {{/loop}}                                    {{else page.current>page.max-2}}                                        {{loop(index) Math.max(0,page.max-4),page.max+1}}                                            <a href="javascript:void(0);"{{if page.current==index}} class="address_current"{{/if}} page="${index}">${index+1}</a>                                        {{/loop}}                                    {{else}}                                        {{loop(index) Math.max(0,page.current-2),Math.min(page.current+3,page.max+1)}}                                            <a href="javascript:void(0);"{{if page.current==index}} class="address_current"{{/if}} page="${index}">${index+1}</a>                                        {{/loop}}                                    {{/if}}                                    {{if page.current<page.max}}                                        <a href="javascript:void(0);" page="${page.current+1}">-&gt;</a>                                    {{/if}}                                </div>                            {{/if}}                        </div>                    </div>                {{/if}}            ',filterStyle:"                .c_address_hd { height: 24px; border-color: #2C7ECF; border-style: solid; border-width: 1px 1px 0; background-color: #67A1E2; color: #fff; line-height: 24px; padding-left: 10px; word-break: break-all; }                .c_address_bd { border-color: #999999; border-style: solid; border-width: 0 1px 1px; overflow: hidden; padding:10px; }                .c_address_select { width:222px; height:355px; font-family: Arial, Simsun; font-size: 12px; }                .c_address_wrap { width: 220px; height:349px; min-height: 305px; margin: 0; padding: 0 0 4px; border: 1px solid #969696; background:#fff; text-align: left; }                .c_address_hd { margin:-1px; }                .c_address_list { margin: 0; padding: 0; height:300px; }                .c_address_list label { border-bottom: 1px solid #FFFFFF; border-top: 1px solid #FFFFFF; display: block; height: 22px; line-height: 22px; min-height: 22px; overflow: hidden; padding: 1px 9px 0; text-align: center; }                .c_address_list span { float: right; font: 10px/22px verdana; margin: 0; overflow: hidden; padding: 0; text-align: right; white-space: nowrap; width: 110px; }                .c_address_list a { border-bottom: 1px solid #FFFFFF; border-top: 1px solid #FFFFFF; color: #0055AA; cursor: pointer; display: block; height: 22px; line-height: 22px; min-height: 22px; overflow: hidden; padding: 1px 9px 0; text-align: left; text-decoration: none; }                .c_address_list a.hover { background: none repeat scroll 0 0 #E8F4FF; border-bottom: 1px solid #7F9DB9; border-top: 1px solid #7F9DB9; }                .address_selected { background: none repeat scroll 0 0 #FFE6A6; color: #FFFFFF; height: 22px; }                .c_address_pagebreak { line-height: 25px; margin: 0; padding: 0; text-align: center; }                .c_address_pagebreak a { color: #0055AA; display: inline-block; font-family: Arial, Simsun, sans-serif; font-size: 14px; margin: 0; padding: 0 4px; text-align: center; text-decoration: underline; width: 15px; }                a.address_current { color: #000; text-decoration: none; }            ",filterInit:i,filterPageSize:12},defaultSuggestionInit:e,defaultSuggestionInit_get:function(){return e},defaultFilterInit:i,defaultFilterInit_get:function(){return i},sortFunction:function(t,e){return t.left>e.left?1:t.left==e.left?0:-1},validate:function(t,e){var i=this,s=this.target.value().trim().replace(/[\|@]/g,"");return s?this.jsonpFilter?(this._filterDataByJsonp(this.jsonpFilter,s,t,!0,function(t){t?(i._select(t,!0),e&&e(!0)):(i._unselect(!1,!0),e&&e(!1))}),!1):(s=this._filterData(this.source.data,s,t,!0))?(this._select(s,!0),e&&e(!0),!0):(this._unselect(!1,!0),e&&e(!1),!1):(this._unselect(!0,!0),!1)},bind:function(t,e,i){return this._event("bind",t,e,i),this},unbind:function(t,e){return this._event("unbind",t,e),this},trigger:function(t,e){return this._event("trigger",t,e),this},focus:function(t){if(this._enabled){var e=this;(t=_.extend({isHidden:!1,isSelected:!1},t)).isHidden&&(e.hidden(),e._enabled=!1,setTimeout(function(){e._enabled=!0})),t.isSelected?e.target[0].select():e.target[0].focus()}},hidden:function(){this._isFocus&&(this._hideSuggestion(),this._hideFilter(),this._tmpValue=this._lastValue=this._fixVal(this.target.value()))},_enable:!1,_parentDocument:null,_parentWindow:null,_iframeDocument:null,_iframeWindow:null,_iframeObject:null,_iframeContainter:null,_lastIframeSize:null,_iframeClock:null,_iframeStyle:"width:0;height:0;position:absolute;top:-100000px;left:-100000px;z-index:200;",_placeHolder:_.browser.isIE?'<pre style="display:none;">placeholder</pre>':"",_isFocus:!1,_focusClock:null,_checkClock:null,_tmpValue:null,_lastValue:null,_isCharIn:!1,_suggestionContainer:null,_suggestionStyle:"position:absolute;top:-100000px;left:-100000px;z-index:200;",_isSuggestionRender:!1,_filterContainer:null,_filterStyle:"position:absolute;top:-100000px;left:-100000px;z-index:200;",_sortReString:null,_displayRegExp:null,_displayHash:null,_colsHash:null,_lastFilterData:null,_lastFilterRendarData:null,_lastSelect:null,_suggestionEnable:!1,_filterEnable:!1,_filterCount:0,_selectFlag:!1,_getLengthRe:/[^\x00-\xFF]/g,_init:function(t,s){if(s.name&&"string"==_.type(name)){var r=this;this._enabled=!0,this.target=_(t),this.scrollTarget?this.scrollTarget=_(this.scrollTarget):this.scrollTarget=this.target,this.name=s.name,s.delay&&"number"==_.type(s.delay)&&0<s.delay&&(this.delay=s.delay),this.source=s.source||this.source,this.jsonpSource=s.jsonpSource||this.jsonpSource,s.jsonpSourceInit&&"function"==_.type(s.jsonpSourceInit)&&(this.jsonpSourceInit=s.jsonpSourceInit),s.jsonpFilterInit&&"function"==_.type(s.jsonpFilterInit)&&(this.jsonpFilterInit=s.jsonpFilterInit),this.charset=s.charset||cQuery.config("charset"),this.source||this.jsonpSource&&_.loader.jsonp(this.jsonpSource,{charset:this.charset,onload:function(t){"function"==_.type(this.jsonpSourceInit)&&(t=this.jsonpSourceInit(t)),this.source_set(t)}.bind(this)}),this.jsonpFilter=s.jsonpFilter||this.jsonpFilter;var e=_.type(s.sort);(s.sort&&"array"==e||"function"==e)&&(this.sort=s.sort,this._sortReString=null),this.sortFunction=s.sortFunction||this.sortFunction,s.display&&(this.display=_.extend(!0,{},this.display,s.display)),this.relate=s.relate||this.relate,s.message&&(this.message=_.extend(!0,{},this.message,s.message)),this.offset="offset"in s?s.offset:this.offset,this.minLength="minLength"in s?s.minLength:this.minLength,this.priority="priority"in s?s.priority:this.priority,this.isAutoCorrect="isAutoCorrect"in s?s.isAutoCorrect:this.isAutoCorrect,this.isFocusNext="isFocusNext"in s?s.isFocusNext:this.isFocusNext,this.isFilterSelect="isFilterSelect"in s?s.isFilterSelect:this.isFilterSelect,s.keyboard&&(this.keyboard=_.extend(!0,{},this.keyboard,s.keyboard)),s.template&&(this.template=_.extend(!0,{},this.template,s.template)),this.isIframe=function(){if(s.hasOwnProperty("isIframe")&&!s.isIframe)return!1;var t=(t=r.target[0].ownerDocument).defaultView||t.parentWindow;try{var e=t.frameElement||!!s.isIframe&&r.target[0];return e&&(r._parentDocument=e.ownerDocument,r._parentWindow=r._parentDocument.defaultView||r._parentDocument.parentWindow,r._iframeObject=_(r._parentDocument.createElement("iframe")),r._iframeObject.css(r._iframeStyle),r._iframeObject[0].frameBorder=0,r._iframeObject.prependTo(r._parentDocument.body),r._iframeObject.html('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="content-type" content="text/html; charset=utf-8" /><title>address</title><style>html,body{padding:0;margin:0;overflow:hidden;}</style></head><body></div></body></html>',function(){r._iframeWindow=r._iframeObject[0].contentWindow||r._iframeObject[0].window,r._iframeDocument=r._iframeWindow.document,r._iframeContainer=_(r._iframeDocument.createElement("container")),r._iframeContainer.css("position","absolute"),r._iframeContainer.appendTo(r._iframeDocument.body)})),!!e}catch(i){return!1}}(),_.bindMethod(this),this.target.attr("autoComplete","on"),this._initTmpl(),this._initEvent(),this._initContentScrollLite({scrollTarget:this.scrollTarget,scrollBody:null,gap:this.scrollGap,animSpeed:this.scrollAnimatingSpeed}),this.uninit=this._uninit}else _.error("mod ("+n.name+","+n.version+") init","invalid name "+name)},_initTmpl:function(){},_initEvent:function(){this.target.bind("focus",this._focus),this.target.bind("blur",this._blur),this.target.bind("keydown",this._keydown),this.target.bind("keypress",this._keypress),this.target.bind("mouseup",this._mouseup),this.target.bind("mousedown",this._focus)},_initContentScrollLite:function(t){this._contentScrollLite=new ContentScrollLite(t)},_initCols:function(){if(!this._colsHash&&(this._colsHash={},this.source.alias))for(var t=0,e=this.source.alias.length;t<e;t++)this._colsHash[this.source.alias[t]]=t},_initSort:function(){if(this._initCols(),!this._sortReString){var t=this._sortReString={accurate:[],vague:[]},e=0,i=0;switch(_.type(this.sort)){case"array":for(var s=0,r=this.sort.length;s<r;s++){var n=this.sort[s].match(/^(\^?)([^\^\$\|@\r\n\+]+)(\+?)(\$?)$/);if(n){if(/^\d$/.test(n[2]))n[2]=parseInt(n[2],10);else{if(!(n[2]in this._colsHash)){_.error("address._initSort","invalid sort column "+n[2]);continue}n[2]=this._colsHash[n[2]]}var a=+n[2]||n[3]?"([^\\|@]*\\|){"+n[2]+(n[3]?",":"")+"}":"";t.accurate[e++]=["@("+a,"","(\\|[^@]*)?)(?=@)"],t.vague[i++]=["@("+a+(n[1]?"":"[^\\|@]*"),"",(n[4]?"(\\|[^@]*)?":"[^@]*")+")(?=@)"]}else _.error("address._initSort","invalid sort rule "+this.sort[s])}break;case"function":break;default:_.error("address._initSort","invalid sort type "+this.sort)}}},_initDisplay:function(){if(this._initCols(),!this._displayHash){var t,e,i=this._displayHash={};for(t in this.display)e=this.display[t],/^\d$/.test(e)?i[t]=parseInt(e,10):e in this._colsHash?i[t]=this._colsHash[e]:(i[t]=null,_.error("address._initDisplay","invalid display column "+arr[1]))}},_refresh:function(){this._tmpValue=this._lastValue=this._sortReString=this._colsHash=null,this._isSuggestionRender=!1,this._isFocus&&this._inputCheck()},_checkEnable:function(){},_focus:function(t){if(this._enabled)if(this._isFocus)!this.source||this._suggestionEnable||this._filterEnable||this._showSuggestion();else if(this._isFocus=!0,this.target.attr("autoComplete","off"),this._isCharIn=!1,this._tmpValue=this._lastValue=null,this._clearFilter(),t&&t.type&&this._inputCheck(),clearTimeout(this._checkClock),clearInterval(this._focusClock),this._focusClock=setInterval(this._focusInterval,100),this.isIframe&&(clearInterval(this._iframeClock),this._iframeClock=setInterval(this._fixIframeSize,100)),t&&t.type){var e=this.target[0];switch(t.type){case"mousedown":setTimeout(function(){e.select()});break;case"focus":e.select()}}},_blur:function(){function e(){var t=i.target.value();i.trigger("userinput",{arguments:{eventType:"blur",target:null,value:s,autoCorrectValue:t,data:null}})}if(this._enabled&&this._isFocus){this._isFocus=!1,this.target.attr("autoComplete","on");var i=this;if(this._hideSuggestion(),this._hideFilter(),clearTimeout(this._checkClock),clearInterval(this._focusClock),this.isIframe&&clearInterval(this._iframeClock),!this._selectFlag){var s=this.target.value();this.isAutoCorrect?this.source?(this._unselect(!1,!0),this.validate(!this.isAutoCorrect,function(t){t||(i._unselect(!0,!1),e())})):(this._unselect(!0,!0),e()):e()}}},_keypress:function(){this._isCharIn=!0},_keydown:function(t){switch(this._isFocus||this._focus(),t.keyCode){case 13:if(!this.keyboard.enter)return!0;if(this._filterEnable&&this._lastSelect){var e=this.target.value(),i=decodeURIComponent(this._lastSelect.attr("data")),s=this._lastSelect[0];this._select(i);var r=this.target.value();this.trigger("userinput",{arguments:{eventType:"keydown",target:s,value:e,autoCorrectValue:r,data:i}});break}this.trigger("enter",{arguments:this.target.value()});break;case 37:case 39:if(!(this.keyboard.left&&37==t.keyCode||this.keyboard.right&&39==t.keyCode))return!0;if(this.template.filterPageSize<0)return!0;if(this._filterEnable&&(i=this._lastFilterRendarData)&&0<=i.page.max)switch(t.keyCode){case 37:0<i.page.current&&this._updateFilter(null,null,i.page.current-1);break;case 39:i.page.current<i.page.max&&this._updateFilter(null,null,i.page.current+1)}break;case 38:case 40:if(!(this.keyboard.up&&38==t.keyCode||this.keyboard.down&&40==t.keyCode))return!0;this._filterEnable&&(s=this._lastSelect,i=this._lastFilterRendarData)&&(e=this._filterContainer.find("*[data]"),null===s?i.list.length&&!this.isFilterSelect&&(s=38==t.keyCode?i.list.length-1:0,this._showHover(e[s])):-1!=(s=e.indexOf(this._lastSelect))&&(s=(s+(i=i.list.length)+t.keyCode-39)%i,this._showHover(e[s])));break;default:return _.browser.isIPadUCWeb&&(this._isCharIn=!0),!0}return t.stop(),!1},_mouseup:function(){var t=this.target[0];t.releaseCapture&&t.releaseCapture()},_getLength:function(t){return t.replace(this._getLengthRe,"  ").length},_focusInterval:function(){var t=this._fixVal(this.target.value());this.source&&this._tmpValue!==t&&(this._tmpValue=t,this.delay?(clearTimeout(this._checkClock),this._checkClock=setTimeout(this._inputCheck,this.delay)):this._inputCheck())},_fixVal:function(t){return t.trim().replace(/[\|@\u2006]/g,"")},_inputCheck:function(){var t=this._fixVal(this.target.value());this.source&&this._lastValue!==t&&(null!==this._lastValue&&(this._isCharIn=!0),this._lastValue=t,this._getLength(t)>=this.minLength&&this._isCharIn?this._showFilter(t):this._showSuggestion())},_showSuggestion:function(){if(this._suggestionEnable=!0,this._hideFilter(),this._clearFilter(),!this._suggestionContainer){if(this.isIframe)(t=this._iframeDocument.createElement("div")).id="address_suggestionContainer_"+this.target.uid();else(t=document.createElement("div")).id="address_suggestionContainer_"+this.target.uid(),t.style.cssText=this._suggestionStyle;this._suggestionContainer=_(t),this._suggestionContainer.bind("mousedown",this._filterMousedown)}if(this._suggestionContainer.appendTo(this.isIframe?this._iframeContainer:_.container),!this._isSuggestionRender){this._isSuggestionRender=!0;var t=[],e=0,s=this._suggestionContainer[0].id;"string"==_.type(this.template.suggestionStyle)&&(t[e++]=this._placeHolder+"<style>"+this.template.suggestionStyle.replace(/(\s*)([^\{\}]+)\{/g,function(t,e,i){return e+i.replace(/([^,]+)/g,"#"+s+" $1")+"{"})+"</style>");var i={data:this.source.suggestion,message:this.message};t[e++]=_.tmpl.render(this.template.suggestion,i),this._suggestionContainer.html(t.join("")),"function"==_.type(this.template.suggestionInit)&&this.template.suggestionInit(this._suggestionContainer),this._suggestionContainer.find(".CQ_suggestionClose").bind("mousedown",this._blur),this.trigger("suggestion",{arguments:[this._suggestionContainer]})}this.isIframe?(this._fixIframeSize(),this._iframeObject.offset(this._fixOffsetSize(this.target,this.offset))):(this._suggestionContainer.offset(this._fixOffsetSize(this.target,this.offset)),this._suggestionContainer.cover()),this._contentScrollLite.checkScroll(this._suggestionContainer)},_fixOffsetSize:function(t,e){var i=t.offset();if(i.top+=i.height,"object"===cQuery.type(e))for(var s in e)i[s]+=e[s];return i},_fixIframeSize:function(){if(this.isIframe){var t=(e=this._iframeContainer[0]).offsetWidth+"px",e=e.offsetHeight+"px";this._lastIframeSize&&t==this._lastIframeSize.width&&e==this._lastIframeSize.height||(this._lastIframeSize={width:t,height:e},this._iframeObject.css(this._lastIframeSize))}},_hideSuggestion:function(){if(this._suggestionEnable=!1,this._suggestionContainer){try{this._suggestionContainer.remove()}catch(t){}this.isIframe?(this._iframeObject.css(this._iframeStyle),this._lastIframeSize=null):(this._suggestionContainer.css(this._suggestionStyle),this._suggestionContainer.uncover())}},_showFilter:function(t){if(this._filterEnable=!0,this._filterCount++,this._hideSuggestion(),!this._filterContainer){if(this.isIframe){var e=this._iframeDocument.createElement("div");e.id="address_filterContainer_"+this.target.uid()}else(e=document.createElement("div")).id="address_filterContainer_"+this.target.uid(),e.style.cssText=this._filterStyle;this._filterContainer=_(e),this._filterContainer.bind("mouseover",this._filterMouseover),this._filterContainer.bind("mousedown",this._filterMousedown)}t=t.replace(/[\|@]/g,""),this.jsonpFilter?this._filterDataByJsonp(this.jsonpFilter,t,!1,!1):this._filterData(this.source.data,t,!1,!1)},_clearFilter:function(){this._lastSelect=this._lastFilterRendarData=this._lastFilterData=null},_filterMouseover:function(t){for(t=t.target;t&&"A"!=t.tagName;)t=t.parentNode;t&&t.getAttribute("data")&&this._showHover(t)},_filterMousedown:function(t){function e(){var t=i.target.value();i.trigger("userinput",{arguments:{eventType:n,target:s,value:a,autoCorrectValue:t,data:r}})}for(var i=this,s=t.target;s&&"A"!=s.tagName;)s=s.parentNode;if(s){var r=decodeURIComponent(s.getAttribute("data"));if(r){var n="mousedown";this._suggestionEnable&&(n="suggestionMousedown"),this._filterEnable&&(n="filterMousedown");var a=this.target.value();_.browser.isIE?(s.onclick=function(){i._select(r),e()},this._isSuggestionRender=!1):(this._select(r),e())}var o=s.getAttribute("page");o&&this._updateFilter("","",+o)}return t.stop(),this.target[0].setCapture&&this.target[0].setCapture(),!1},_hideFilter:function(){if(this._filterEnable=!1,this._filterContainer){try{this._filterContainer.remove()}catch(t){}this.isIframe?(this._iframeObject.css(this._iframeStyle),this._lastIframeSize=null):(this._filterContainer.css(this._filterStyle),this._filterContainer.uncover())}},_filterData:function(t,e,i,s){this._initSort(),this._initDisplay();var r=this,n=[],a=0,o=t;switch(_.type(this.sort)){case"array":t=this._sortReString[i?"accurate":"vague"],i=e.toReString();for(var l="array"==_.type(this.message.sort)?this.message.sort:[],h=0,c=t.length;h<c;h++){t[h][1]=i;var u=RegExp(t[h].join(""),"gi"),d=[],f=0;o=o.replace(u,function(t,e){var i={left:(i=e.split("|"))[r._displayHash.left]||"",right:i[r._displayHash.right]||"",data:e};return d[f++]=i,""});if(f){if(d.sort(this.sortFunction),s)return d[0].data;l[h]&&d.unshift(_.tmpl.render(l[h],{val:e,items:d})),n[a++]=d}}if(s)return!1;break;case"function":if(d=this.sort(t,e,i,s),s)return!!d.length&&d[0].data;n[a++]=d;break;default:return _.error("address._filterData","invalid sort type"),!1}n=Array.prototype.concat.apply([],n),this._updateFilter(n,e)},_filterDataByJsonp:function(t,n,e,a,o){this._initSort(),this._initDisplay();var l=[],h=0,c=this._filterCount;if(t=_.tmpl.render(t,{key:encodeURIComponent(escape(n)),accurate:e?1:0}),_.loader.jsonp(t,{charset:this.charset,onload:function(t){if((this._filterEnable||a)&&c==this._filterCount){"function"==_.type(this.jsonpFilterInit)&&(t=this.jsonpFilterInit(t,n));for(var e=t.data.split("@"),i=0,s=e.length;i<s;i++)if(e[i]){if(a)return void("function"==_.type(o)&&o(e[i]));if("$="==e[i].slice(0,2))var r=_.tmpl.render(e[i].slice(2),{val:n});else r={left:(r=e[i].split("|"))[this._displayHash.left]||"",right:r[this._displayHash.right]||"",data:decodeURIComponent(e[i])};l[h++]=r}a&&!h?"function"==_.type(o)&&o(null):this._updateFilter(l,t.key)}}.bind(this)}),a)return!1},_updateFilter:function(t,e,i){var s,r,n=[],a=0,o=this._filterContainer[0].id;"string"==_.type(this.template.filterStyle)&&(n[a++]=this._placeHolder+"<style>"+this.template.filterStyle.replace(/(\s*)([^\{\}]+)\{/g,function(t,e,i){return e+i.replace(/([^,]+)/g,"#"+o+" $1")+"{"})+"</style>"),"array"==_.type(t)?t.length?(s=this._lastFilterData=t||[],r=!0):(s=this._lastFilterData||[],r=!1):(s=this._lastFilterData||[],r=!!this._lastFilterRendarData&&this._lastFilterRendarData.hasResult),t=this._lastSelect?this._filterContainer.find("*[data],label").indexOf(this._lastSelect):-1,i=i||0;var l=this.template.filterPageSize;l<0&&(l=s.length);var h=Math.ceil(s.length/l)-1;i=Math.min(Math.max(0,i),h),s=h+1?s.slice(i*l,Math.min((i+1)*l,s.length)):null,this._lastFilterRendarData=e={val:e||this._lastValue,hasResult:r,list:s,page:{max:h,pageSize:l,current:i},message:this.message},e.list=e.list?e.list:[],n[a++]=_.tmpl.render(this.template.filter,e),this._filterContainer.html(n.join("")),"function"==_.type(this.template.filterInit)&&this.template.filterInit(this._filterContainer),this._filterContainer.find(".CQ_filterClose").bind("mousedown",this._blur),this.trigger("filter",{arguments:[this._filterContainer]}),n=this._filterContainer.find("*[data],label"),t=e.list&&e.list.length?Math.max(this.isFilterSelect?0:-1,Math.min(t,e.list.length-1,n.length-1)):-1,n[0]?(-1!=t&&"LABEL"==n[t].tagName&&(t=t==n.length-1?t-1:t+1),this.isFilterSelect?this._showHover(n[t]):this._showHover()):this._showHover(),this.isIframe?(this._filterContainer.appendTo(this._iframeContainer),this._fixIframeSize(),this._iframeObject.offset(this._fixOffsetSize(this.target,this.offset))):(this._filterContainer.appendTo(_.container),this._filterContainer.offset(this._fixOffsetSize(this.target,this.offset)),this._filterContainer.cover()),this._contentScrollLite.checkScroll(this._filterContainer)},_showHover:function(t){if(t?t=_(t):this.isFilterSelect&&(t=this._filterContainer.find("*[data]:first")),this._lastSelect){if(t&&t[0]&&this._lastSelect[0]==t[0])return;this._lastSelect.removeClass("hover")}t&&t[0]?(t.addClass("hover"),this._lastSelect=t):this._lastSelect=null},_getItems:function(t){this._initCols();for(var e={length:(t=t.split("|")).length},i=0,s=t.length;i<s;i++)e[i]=t[i];var r=this.source.alias;if(r)for(i=0,s=r.length;i<s;i++)e[r[i]]=t[i];return e},_select:function(t,e){var i=this;this._selectFlag=!0,setTimeout(function(){i._selectFlag=!1}),this._initDisplay();var s=t.split("|"),r=s[this._displayHash.value]||"";if(this._tmpValue=this._lastValue=this._fixVal(r),this.target.value(r),this._clearFilter(),this._hideSuggestion(),this._hideFilter(),this.relate)for(var n in this.relate)if(this.relate.hasOwnProperty(n)){var a=_(this.relate[n]);if(a[0]){if(/^\d$/.test(n))n=parseInt(n,10);else{if(!(n in this._colsHash)){_.error("address._select","invalid relate column "+n);continue}n=this._colsHash[n]}a.value(s[n]||"")}else _.error("address._select","invalid relate element")}if(this.trigger("change",{arguments:{value:r,data:t,items:this._getItems(t)}}),!e&&this.isFocusNext){var o=null;if(_.isCDom(this.isFocusNext))o=this.isFocusNext[0];else switch(_.type(this.isFocusNext)){case"string":o=_(this.isFocusNext)[0];break;case"object":"focus"in this.isFocusNext&&(o=this.isFocusNext);break;case"boolean":if(s=this.target[0].form)for(n=r=0,a=(s=s.elements).length-1;n<a;n++){if(r){var l=_(s[n]);if((s[n].offsetWidth||s[n].offsetHeight)&&"none"!==l.css("display")&&"hidden"!==l.css("visibility")){o=s[n];break}}s[n]==this.target[0]&&(r=1)}}o&&setTimeout(function(){try{o.focus()}catch(t){}})}},_unselect:function(t,e){if(t&&(this._tmpValue=this._lastValue=null,this.target.value(""),this._clearFilter(),this._hideSuggestion(),this._hideFilter(),this.trigger("change",{arguments:{value:"",data:"",items:null}})),e&&this.relate)for(var i in this.relate)if(this.relate.hasOwnProperty(i)){var s=_(this.relate[i]);s[0]?s.value(""):_.error("address._select","invalid relate element")}},_event:function(t,e){switch(_.type(e)){case"string":e=[e];break;case"array":break;default:return void _.error("address."+t,"Invalid types "+e)}for(var i,s=0,r=e.length;s<r;s++)(i=e[s].trim())&&"string"==_.type(i)?i in a?this.target[t].apply(this.target,[i+o].concat(Array.prototype.slice.call(arguments,2))):_.error("address."+t,"Unsupport type "+i):_.error("address."+t,"Invalid type "+i)},_uninit:function(){}}),_.mod.reg(n),"function"==typeof define&&define.amd&&define.amd.jQuery&&define("cAddress",["cQuery"],function(){return n.module})}(cQuery);