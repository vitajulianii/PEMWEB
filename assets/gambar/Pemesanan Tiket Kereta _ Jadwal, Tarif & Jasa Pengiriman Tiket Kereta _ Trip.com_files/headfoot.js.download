!function(r,a){var c,s,n,i,t,o,e,l,u,g,h,d,f,_,m,p,C,v,I,A,E,k,y,N,b="undefined"!=typeof __PAGE_CONFIG__?__PAGE_CONFIG__.i18n&&__PAGE_CONFIG__.i18n.processing:"Processing...",L=r.__SITE_CONFIG__||{},S=(e=function(e){if(!("function"===(n=typeof(t=e))||"object"===n&&t))return e;for(var t,n,i,o,a=1,r=arguments.length;a<r;a++)for(o in i=arguments[a])Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o]);return e},l=function(){var g=function(e){return e instanceof g?e:this instanceof g?void(this._wrapped=e):new g(e)},e=Array.prototype,t=Object.prototype,n=Function.prototype,r=(e.push,e.slice),i=(e.concat,t.toString),o=t.hasOwnProperty,a=Array.isArray,c=Object.keys;n.bind;g.keys=function(e){if(!g.isObject(e))return[];if(c)return c(e);var t=[];for(var n in e)g.has(e,n)&&t.push(n);return t},g.has=function(e,t){return null!=e&&o.call(e,t)},g.partial=function(o){var a=r.call(arguments,1);return function(){for(var e=0,t=a.slice(),n=0,i=t.length;n<i;n++)t[n]===g&&(t[n]=arguments[e++]);for(;e<arguments.length;)t.push(arguments[e++]);return o.apply(this,t)}},g.before=function(e,t){var n;return function(){return 0<--e?n=t.apply(this,arguments):t=null,n}},g.once=g.partial(g.before,2),g.isArray=a||function(e){return"[object Array]"===i.call(e)},g.isObject=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},g.each=g.forEach=function(e,t,n){if(null==e)return e;t=function(o,a,e){if(void 0===a)return o;switch(null==e?3:e){case 1:return function(e){return o.call(a,e)};case 2:return function(e,t){return o.call(a,e,t)};case 3:return function(e,t,n){return o.call(a,e,t,n)};case 4:return function(e,t,n,i){return o.call(a,e,t,n,i)}}return function(){return o.apply(a,arguments)}}(t,n);var i,o=e.length;if(o===+o)for(i=0;i<o;i++)t(e[i],i,e);else{var a=g.keys(e);for(i=0,o=a.length;i<o;i++)t(e[a[i]],a[i],e)}return e},g.each(["Arguments","Function","String","Number","Date","RegExp"],function(t){g["is"+t]=function(e){return i.call(e)==="[object "+t+"]"}}),g.isEmpty=function(e){if(null==e)return!0;if(g.isArray(e)||g.isString(e)||g.isArguments(e))return 0===e.length;for(var t in e)if(g.has(e,t))return!1;return!0};var s={on:function(e,t,n){return h(this,"on",e,[t,n])&&t&&(this._events||(this._events={}),(this._events[e]||(this._events[e]=[])).push({callback:t,context:n,ctx:n||this})),this},once:function(e,t,n){if(!h(this,"once",e,[t,n])||!t)return this;var i=this,o=g.once(function(){i.off(e,o),t.apply(this,arguments)});return o._callback=t,this.on(e,o,n)},off:function(e,t,n){var i,o,a,r,c,s,l,u;if(!this._events||!h(this,"off",e,[t,n]))return this;if(!e&&!t&&!n)return this._events=void 0,this;for(c=0,s=(r=e?[e]:g.keys(this._events)).length;c<s;c++)if(e=r[c],a=this._events[e]){if(this._events[e]=i=[],t||n)for(l=0,u=a.length;l<u;l++)o=a[l],(t&&t!==o.callback&&t!==o.callback._callback||n&&n!==o.context)&&i.push(o);i.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=r.call(arguments,1);if(!h(this,"trigger",e,t))return this;var n=this._events[e],i=this._events.all;return n&&u(n,t),i&&u(i,arguments),this},stopListening:function(e,t,n){var i=this._listeningTo;if(!i)return this;var o=!t&&!n;for(var a in n||"object"!=typeof t||(n=this),e&&((i={})[e._listenId]=e),i)(e=i[a]).off(t,n,this),(o||g.isEmpty(e._events))&&delete this._listeningTo[a];return this}},l=/\s+/,h=function(e,t,n,i){if(!n)return!0;if("object"==typeof n){for(var o in n)e[t].apply(e,[o,n[o]].concat(i));return!1}if(l.test(n)){for(var a=n.split(l),r=0,c=a.length;r<c;r++)e[t].apply(e,[a[r]].concat(i));return!1}return!0},u=function(e,t){var n,i=-1,o=e.length,a=t[0],r=t[1],c=t[2];switch(t.length){case 0:for(;++i<o;)(n=e[i]).callback.call(n.ctx);return;case 1:for(;++i<o;)(n=e[i]).callback.call(n.ctx,a);return;case 2:for(;++i<o;)(n=e[i]).callback.call(n.ctx,a,r);return;case 3:for(;++i<o;)(n=e[i]).callback.call(n.ctx,a,r,c);return;default:for(;++i<o;)(n=e[i]).callback.apply(n.ctx,t);return}};return g.each({listenTo:"on",listenToOnce:"once"},function(o,e){s[e]=function(e,t,n){var i=this._listeningTo||(this._listeningTo={});return n||"object"!=typeof t||(n=this),(i[e._listenId||(e._listenId=g.uniqueId("l"))]=e)[o](t,n,this),this}}),s}(),u=e({set:function(e,t,n,i,o){n=new Date((new Date).getTime()+1e3*(void 0===n?86400:n)),r.__SITE_CONFIG__&&r.__SITE_CONFIG__.cookiedomain&&void 0===o&&(o=r.__SITE_CONFIG__.cookiedomain[__SITE_CONFIG__.page.site]);var a=e+"="+encodeURIComponent(t)+(n?"; expires="+n.toGMTString():"")+(i?"; path="+i:"; path=/")+(o?"; domain="+o:".ctrip.com");return a.length<4096?document.cookie=a:function(){throw new Error("The cookie is bigger than cookie lagrest")}(),this.trigger("set",e,t,n,i,o),!!this.get(e)},get:function(e){var t=document.cookie.match(new RegExp("(^| )"+e+"=([^;]*)(;|$)")),n=null;return null!=t&&(n=t[2]&&decodeURIComponent(t[2])),this.trigger("get",e,n),n},del:function(e,t,n){return this.get(e)&&(document.cookie=e+"="+(t?"; path="+t:"; path=/")+(n?"; domain="+n:"")+";expires=Thu, 01-Jan-1970 00:00:01 GMT"),this.trigger("del",e,t,n),!this.get(e)}},l),g=e({get:function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),n=location.search.substr(1).match(t),i=n&&n[2],o=i?decodeURIComponent(i):null;return this.trigger("get",e,o),o},add:function(e,t,n){var i=(e=this.remove(e,t)).indexOf("?"),o=e.indexOf("#"),a=e.split("#"),r=t+"="+n,c=null;return 0<o&&(e=a[0]),e=0<i?(c=e.split("?"))[0]+"?"+r+"&"+c[1]:e+"?"+r,0<o&&(e+="#"+a[1]),e.replace(/&{2,}/g,"&").replace(/&{1,}$/g,"").replace(/&(?=#)/,"")},adds:function(e,t){if(t&&0<t.length)for(var n=0;n<t.length;n++){var i=t[n]&&t[n].key,o=t[n]&&t[n].value;e=this.add(e,i,o)}return e},remove:function(e,t){var n=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),i=location.search.substr(1).match(n);return null!=i&&(e=e.replace(i[0],"&").replace(/&{1,}$/g,"")),this.trigger("remove",t,e),e},removeHash:function(e){var t=null;return e&&0<(t=e.indexOf("#"))&&(e=e.substring(0,t)),e},getHash:function(e){if(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),n=location.hash.slice(1).match(t),i=n&&n[2];return i?decodeURIComponent(i):null}return location.hash.slice(1)}},l),h=e({_initFlag:!(i={welcomeToHKEN:"Welcome to Ctrip Hong Kong!",welcomeToHKCN:"歡迎來到Ctrip香港！",pleaseSelectYourPreferredLangEN:"Please select your preferred language",pleaseSelectYourPreferredLangCN:"請選擇語言",english:"English",fangTi:"繁體"}),isMobile:!(s={}),isLogin:!(c={header:".header-box",menu:"#hd-menu",menuItem:".hd-func-dropdown",menuItemActive:"hd-func-dropdown-active",menuItemIcon:".hd-cur-item",help:".hd-help",currency:".hd-currency",language:".hd-language",account:".hd-account",currencyList:".hd-currency-list",languageList:".hd-language-list",langLessState:"hd-language-list-less",accountList:".hd-account-menu",listItem:"a",listItemActive:"active",accountLink:".hd-account-link",accountIcon:".icon-account-ms",accountIconBefore:"icon-account-ms",accountIconAfter:"icon-account-msa",accountName:".hd-account-login,.hd-account-name",toggleFull:".hd-toggle-full",toggleAccount:".hd-toggle-account",toggleAccountIcon:".icon-account-r",toggleAccountIconBefore:"icon-account-r",toggleAccountIconAfter:"icon-account-ra",toggleMenu:".hd-toggle-menu",menuShowAccount:"hd-menu-show-account",menuShowAll:"hd-menu-show-all",listReviewItem:"[data-type=reviews]"}),ui:s,css:c,methodEnum:{get:"GET",post:"POST"},_languageIconTpl:'<i class="c-icon icon-flag icon-${languageCode}"></i> ${languageText}<i class="c-icon icon-select-angle"></i>',_currencyIconTpl:'${currencyCode}<i class="c-icon icon-select-angle"></i>',_loginBeforeTpl:'<a href="javascript:void(0)" data-target="${accountdomain}${link.signin}" data-type="signin" target="${target}" rel="nofollow">${i18n.signin}</a><a href="${accountdomain}${link.register}" data-type="register" target="${target}" rel="nofollow">${i18n.register}</a><a class="account-guest" href="${accountdomain}${link.guestbookings}" data-type="guestbooking" target="${target}" rel="nofollow">${i18n.bookasguest}<span>${i18n.searchbyemail}</span></a>',_loginBeforeAbTpl:'<a href="javascript:void(0)" data-target="${account_ab_domain}${link.signin}${parameter}" data-type="signin" target="${target}" rel="nofollow">${i18n.signin}</a><a href="${account_ab_domain}${link.register}" data-type="register" target="${target}" rel="nofollow">${i18n.register}</a><a class="account-guest" href="${accountdomain}${link.guestbookings}" data-type="guestbooking" target="${target}" rel="nofollow">${i18n.bookasguest}<span>${i18n.searchbyemail}</span></a>',_loginAfterTpl:'<a href="${accountdomain}${link.mybookings}" data-type="mybookings" target="${target}" rel="nofollow">${i18n.mybookings}</a><a href="${accountdomain}${link.reviews}" data-type="reviews" target="${target}" rel="nofollow">${i18n.reviews}</a><a href="${accountdomain}${link.profile}" data-type="profile" target="${target}" rel="nofollow">${i18n.profile}</a><div class="hd-menu-sp"></div><a href="javascript:void(0)" data-target="${accountdomain}${link.signout}" data-type="signout" target="${target}" rel="nofollow">${i18n.signout}</a>',_loginBeforeH5Tpl:'<a href="javascript:void(0)" data-target="${accountdomain}${link.signin}" data-type="signin" target="${target}" rel="nofollow">${i18n.signin}</a><a href="${accountdomain}${link.register}" data-type="register" target="${target}" rel="nofollow">${i18n.register}</a><a class="account-guest" href="${accountdomain}${link.guestbookings}" data-type="guestbooking" target="${target}" rel="nofollow">${i18n.bookasguest}<span>${i18n.searchbyemail}</span></a>',_loginAfterH5Tpl:'<a href="${h5Domain}${link.mybookings}" data-type="mybookings" target="${target}" rel="nofollow">${i18n.mybookings}</a><a href="${accountH5domain}${link.reviews}" data-type="reviews" target="${target}" rel="nofollow">${i18n.reviews}</a><a href="${accountH5domain}${link.profile}" data-type="profile" target="${target}" rel="nofollow">${i18n.profile}</a><div class="hd-menu-sp"></div><a href="javascript:void(0)" data-target="${accountdomain}${link.signout}" data-type="signout" target="${target}" rel="nofollow">${i18n.signout}</a>',CURRENCY_COOKIE_NAME:"cookiePricesDisplayed",LANGUAGE_COOKIE_NAME:"ibulanguage",CANTON_FAIR_2016_SPRING:"_fmh",CANTON_FAIR_2016_SPRING_VALUE:"GJH",LANGUAGE_PARAM_NAME:"language",DEFAULT_SITE_CODE:"EN",DEFAULT_LANG_CODE:"EN",CURRENCY_PARAM_NAME:"curr",DEFAULT_COOKIE_DOAMIN:".ctrip.com",SITE_PARAM_FIELDS:"#PostHiddenFields",MIN_LANG_LIST:4,_HAS_LANG_LIST:!(n=null),_INPUT_TMPL:"{{enum(k, v) $data}}<input type=\"hidden\" name='${k}' value='${v}' />{{/enum}}",_REVIES_COUNT_TIP:'<span class="badge">\x3c!--a href="${link}" target="_blank"--\x3e${count}\x3c!--/a--\x3e</span>',SITE_LANG_ENUM:{DE:"DE",EN:"EN",ES:"ES",FR:"FR",HK:"繁",ID:"ID",JP:"JP",KR:"KR",MY:"MY",RU:"RU",SG:"EN",TH:"TH"},URLs:{emailCountUrl:"/main/tool/getpromptcount",emailDetailInfoUrl:"/main/tool/GetPromptOrder",removeEmailUrl:"/main/tool/RemoveEachPrompt"},init:function(){this._initFlag||(this.checkIsHKSite(),this.updateAccountURI(),this.updateCookies(),this.trigger("init:before"),this._initFlag=!0,this._getElements(),this.isSampleHeader(),this.checkIsMobile(),this.initHeaderState(),this.checkAccountInfo(),this.trigger("init"),m.page.trigger("header_init"),this._bindEvent(),this._bindResize(),this.trigger("init:after"),this.updateUnionCode(),this.cantonfair2016spring(),this.checkNeedShowLoginState())},checkIsHKSite:function(){if(!this.isEasytrip()){var e=g.getHash("from");"1"!==a.trim(g.get("iburedirect"))&&"click_hk"!==e&&"click_hken"!==e||this.setChoosePanelCookie(),!u.get("_f_l_hk")&&L.page&&"HK"===L.page.site&&/^\/(main|flights|hotels|trains|packages)?(\/)?$/i.test(location.pathname)&&this.createChoosePanel()}},createChoosePanel:function(){var e=a("body"),t=this.createElem('<div class="overlay-bg overlay-bg-light"></div>'),n=this.createElem(a.tmpl.render('<div class="PACK_BOX pack-box pack-pop pack-pop-round"><div class="pop-con"><div class="pop-cnt"> <h2 class="pop-tit">${welcomeToHKEN}</h2><h2 class="pop-tit">${welcomeToHKCN}</h2><div class="txt-weaken"><p>${pleaseSelectYourPreferredLangEN}</p><p>${pleaseSelectYourPreferredLangCN}</p></div></div><div class="pop-action"><a href="javascript:;" class="c-btn btn-outline btn-xl" data-site="EN">${english}</a><a href="javascript:;" class="c-btn btn-outline btn-xl" data-site="HK">${fangTi}</a></div><span class="pop-close"><span class="c-icon icon-close-btn"></span></span></div></div>',i));s.chooseBg=t.show(),s.choosePanel=n.show(),e.append(t),e.append(n),this.bindChooseEvent()},bindChooseEvent:function(){var e=this;s.choosePanel.on("click",".btn-xl",function(){switch(a(this).data("site")){case"EN":L.page&&"EN"!==L.page.language&&e.changeLanguage("HK","EN","");break;case"HK":L.page&&"HK"!==L.page.language&&e.changeLanguage("HK","HK","")}e.setChoosePanelCookie(),e.hideChoosePanel()}).on("click",".icon-close-btn",function(){e.setChoosePanelCookie(),e.hideChoosePanel()})},setChoosePanelCookie:function(){var e=L.page&&L.page.site&&L.cookiedomain[L.page.site]||null;this.isEasytrip()&&(e=L.page&&L.page.sitegroup&&L.cookiedomain[L.page.sitegroup]||null),u.set("_f_l_hk","1",2592e3,"/",e)},hideChoosePanel:function(){s.chooseBg.hide(),s.choosePanel.hide()},updateAccountURI:function(){var e=this.getPageLanguageCode(),t=this.getPageCurrencyCode();for(var n in L.accounturi)L.accounturi[n]=g.add(g.add(L.accounturi[n],this.LANGUAGE_PARAM_NAME,e),this.CURRENCY_PARAM_NAME,t);for(n in L.accountH5uri)L.accountH5uri[n]=g.add(g.add(L.accountH5uri[n],this.LANGUAGE_PARAM_NAME,e),this.CURRENCY_PARAM_NAME,t)},updateCookies:function(){var e=this.getLangByParam(),t=this.getLangByCookie(),n=this.getCurrByParam();e&&e!==t?this.setLanguageCookie(e):this.setLanguageCookie(L.page.language),n&&this.setCurrencyCookie(n)},isSampleHeader:function(){"SimpleHead"===L.page.headtype&&(s.menu.find(c.language).hide(),s.menu.find(c.currency).hide())},checkIsMobile:function(){try{this.isMobile=s.toggleAccount.is(":visible")&&!(0<=navigator.userAgent.indexOf("iPad"))}catch(e){throw new Error("checking is mobile has error")}},updateAccountState:function(){this.isLogin?this.renderLoginAfterMenuList():this.renderLoginBefore()},initHeaderState:function(){this.selectCurrencyListItem(this.getPageCurrencyCode()),this.selectLangListItem(this.getPageLanguageCode(),this.getSiteCode()),this.renderLoginBefore()},checkAccountInfo:function(){this.createAccountCallback(),this.trigger("login:before",s),a.loader.js(L.accountdomain+L.accountinfo+"?language="+this.getPageLanguageCode()+"&t="+ +new Date),this.createAccountCallback()},createAccountCallback:function(){var t=this;r.Global=r.Global||{},r.Global.Singleton=r.Global.Singleton||{},r.Global.Singleton.ParseAccountInfoBarSignIn=function(e){e?(t.hideLoginState(),t.isLogin=!0,t._loginData=e,t.renderLoginAfter(e),t.trigger("login",e,s),m.page.trigger("login",e,s),t.trigger("login:after",e,s)):(t.isLogin=!1,t._loginData=null,t.renderLogout(),t.trigger("logout",e,s),m.page.trigger("logout",e,s))}},checkNeedShowLoginState:function(){this.isLogin||/^\/(|trains|main|hotels|ttd|carrental|flights)\/{0,1}$/.test(location.pathname)&&this.showLoginState()},showLoginState:function(){this.__LOGIN_STATE_TIMER&&clearTimeout(this.__LOGIN_STATE_TIMER),this.__LOGIN_STATE_TIMER=setTimeout(function(){this.hideLoginState()}.bind(this),8e3),s.account&&s.account.addClass(c.menuItemActive)},hideLoginState:function(){this.__LOGIN_STATE_TIMER&&clearTimeout(this.__LOGIN_STATE_TIMER),s.account&&s.account.removeClass(c.menuItemActive)},getLoginInfo:function(){return this._loginData},createElem:function(e){var t=a(document.createElement("div"));return t.html(e),t.children()},addReviewsInfo:function(e){var t=s.accountList.find(c.listReviewItem),n=a.tmpl.render(this._REVIES_COUNT_TIP,{count:e}),i=this.createElem(n),o=this.createElem(n);i.insertBefore(s.accountName),t.append(o)},getPostHiddenFields:function(){var e=document.getElementById("PostHiddenFields");if(e&&e.value){for(var t,n=/name='([^\']*)'\s*value='([^\']*)'\s*\/>/g,i=[];t=n.exec(e.value);)if(t&&3<=t.length){var o={};o.name=t[1],o.value=t[2],i.push(o)}return i}return[]},getPayload:function(){var e=document.getElementById("PostHiddenFields"),t=["SelectedFlightLimit","SelectedFlightDesc"];if(e&&e.value){for(var n,i=/name='([^\']*)'\s*value='([^\']*)'\s*\/>/g,o=[];n=i.exec(e.value);)if(n&&3<=n.length){var a=n[1];t.indexOf(a)<0&&o.push(n[1]+"="+encodeURIComponent(n[2]))}return o.join("&")}return""},renderLoginBefore:function(){if(this.isMobile)(e=L.accountH5uri).guestbookings=L.accounturi.guestbookings,e.signin=L.accounturi.signin,e.register=L.accounturi.register,s.accountList.html(a.tmpl.render(this._loginBeforeH5Tpl,{accountdomain:L.accountdomain,accountH5domain:L.accountH5domain,link:e,i18n:L.i18n,target:"_self"}));else{var e=L.accounturi;s.accountList.html(a.tmpl.render(this._loginBeforeAbTpl,{account_ab_domain:"https://"+S.siteConfig.domain[S.siteConfig.page.site]+"/account/",accountdomain:L.accountdomain,parameter:"&backurl="+encodeURIComponent(r.location.href),link:e,i18n:L.i18n,target:"_self"}))}},renderLoginAfter:function(e){this.udpateAccountName(e),s.accountIcon.removeClass(c.accountIconBefore).addClass(c.accountIconAfter),s.toggleAccountIcon.removeClass(c.toggleAccountIconBefore).addClass(c.toggleAccountIconAfter),this.renderLoginAfterMenuList()},renderLogout:function(){this.udpateAccountName(this.__signIn_I18n),s.accountIcon.addClass(c.accountIconBefore).removeClass(c.accountIconAfter),s.toggleAccountIcon.addClass(c.toggleAccountIconBefore).removeClass(c.toggleAccountIconAfter),this.renderLoginBefore()},renderLoginAfterMenuList:function(){this.isMobile?(L.accountH5uri.mybookings="order/",L.accountH5uri.signout=L.accounturi.signout,s.accountList.html(a.tmpl.render(this._loginAfterH5Tpl,{accountH5domain:L.accountH5domain,accountdomain:L.accountdomain,h5Domain:"https://"+L.domain[L.page.site]+"/m/",link:L.accountH5uri,i18n:L.i18n,target:"_self"}))):s.accountList.html(a.tmpl.render(this._loginAfterTpl,{accountdomain:L.accountdomain,link:L.accounturi,i18n:L.i18n,target:"_self"}))},udpateAccountName:function(e){!this.__signIn_I18n&&s&&s.accountName&&s.accountName.html&&(this.__signIn_I18n=s.accountName.html()),s&&s.accountName&&s.accountName.html&&s.accountName.html(e)},selectLangListItem:function(t,n){var i=this,o=0;s.languageList.find(c.listItem).each(function(e){"none"===e.data("display")&&o++,e.data("languageCode")===t&&e.data("siteCode")===n&&(e.addClass(c.listItemActive),i.renderLangIcon({languageCode:n.toLowerCase(),languageText:i.SITE_LANG_ENUM[t]}))}).length||(this._HAS_LANG_LIST=!1),this.MIN_LANG_LIST<=o&&s.languageList.addClass(c.langLessState)},selectCurrencyListItem:function(t){var n=this;s.currencyList.find(c.listItem).each(function(e){e.data("currencyCode")===t&&(e.addClass(c.listItemActive),n.renderCurrencyIcon({currencyCode:t}))})},renderLangIcon:function(e){s.menu.find(c.language).find(c.menuItemIcon).html(a.tmpl.render(this._languageIconTpl,e))},renderCurrencyIcon:function(e){s.menu.find(c.currency).find(c.menuItemIcon).html(a.tmpl.render(this._currencyIconTpl,e))},pageMethodIsGet:function(){return this.getPageMethod()===this.methodEnum.get},pageMethodIsPost:function(){return this.getPageMethod()===this.methodEnum.post},getPageMethod:function(){return L.page.method},setLanguageCookie:function(e){u.set(this.LANGUAGE_COOKIE_NAME,e,2592e3,"/",this.getCookieDomainBySiteCode(this.getPageSiteCode()))},getSiteCode:function(){return L&&L.page&&L.page.site?L.page.site:this.DEFAULT_SITE_CODE},sendGAQ:function(e){r._gaq&&_gaq.push&&_gaq.push(["_trackEvent","_MultiCurrency","click",e])},changeCurrency:function(e){var t=this.getCookieDomainBySiteCode(this.getPageSiteCode()),n=null;if(e){if(this.trigger("currency",e),n=g.add(document.URL,this.CURRENCY_PARAM_NAME,e),this.setCurrencyCookie(e,t),this.pageMethodIsGet())this.changeSiteByGet(n);else{if(!this.pageMethodIsPost())throw new Error("page method is error!");this.changeSiteByPost(n,this.getParamFields())}this.renderCurrencyIcon({currencyCode:e}),d.getInstance({i18n:{loading:b}}).show()}},setCurrencyCookie:function(e,t){u.set(this.CURRENCY_COOKIE_NAME,e,2592e3,"/",t||this.getCookieDomainBySiteCode(this.getPageSiteCode()))},getPageCurrencyCode:function(){var e=h.getCurrByParam();return e||(e=u.get(this.CURRENCY_COOKIE_NAME),this.checkHasCurr(e)?e:this.getCurrencyByLang(this.getSiteCode()))},getCurrencyByLang:function(e){return L.defaultsitecurrency&&L.defaultsitecurrency[e]},getCookieDomainBySiteCode:function(e){return L.cookiedomain[e]},getPageLanguageCode:function(){return this.getLangByParam()||L.page&&L.page.language||this.DEFAULT_LANG_CODE},getPageSiteCode:function(){return this.isEasytrip()?L.page.sitegroup:L.page&&L.page.site||this.DEFAULT_SITE_CODE},getLangByParam:function(){var e=g.get(this.LANGUAGE_PARAM_NAME)&&g.get(this.LANGUAGE_PARAM_NAME).toUpperCase();if(e&&L.cookiedomain[e])return e},getLangByCookie:function(){var e=u.get(this.LANGUAGE_COOKIE_NAME)&&u.get(this.LANGUAGE_COOKIE_NAME).toUpperCase();if(e&&L.cookiedomain[e])return e},checkHasCurr:function(e){return!L.allcurrency||L.allcurrency&&-1!==L.allcurrency.indexOf(e)},getCurrByParam:function(){var e=g.get(this.CURRENCY_PARAM_NAME)&&g.get(this.CURRENCY_PARAM_NAME).toUpperCase();if(e&&this.checkHasCurr(e))return e},changeLanguage:function(e,t,n){var i=null;if(t){if(this.trigger("language",e,t),i=location.protocol+"//"+this.getDomainBySiteCode(e)+location.pathname+location.search+location.hash,i=g.remove(i,this.CURRENCY_PARAM_NAME),i=g.add(g.add(i,this.LANGUAGE_PARAM_NAME,t),this.CURRENCY_PARAM_NAME,this.getCurrencyByLang(e)),this.pageMethodIsGet())this.changeSiteByGet(i);else{if(!this.pageMethodIsPost())throw new Error("page method is error!");this.changeSiteByPost(i,this.getParamFields())}this.renderLangIcon({languageCode:e.toLowerCase(),languageText:this.SITE_LANG_ENUM[t]}),d.getInstance({i18n:{loading:b}}).show()}},changeSite:function(){},_getElements:function(){s.header=a(c.header),s.menu=s.header.find(c.menu),s.currencyList=s.menu.find(c.currencyList),s.languageList=s.menu.find(c.languageList),s.accountList=s.menu.find(c.accountList),s.accountIcon=s.menu.find(c.accountIcon),s.accountName=s.menu.find(c.accountName),s.account=s.header.find(c.account),s.toggleFull=s.header.find(c.toggleFull),s.toggleAccount=s.toggleFull.find(c.toggleAccount),s.toggleMenu=s.toggleFull.find(c.toggleMenu),s.toggleAccountIcon=s.toggleAccount.find(c.toggleAccountIcon)},clearMenuTimer:function(){n&&clearTimeout(n)},addMenuTimer:function(e,t){this.clearMenuTimer(),n=setTimeout(e,t||150)},hideMenuItems:function(t){t&&t.length?s.menu.find(c.menuItem).each(function(e){t[0]!==e[0]&&e.removeClass(c.menuItemActive)}):s.menu.find(c.menuItem).removeClass(c.menuItemActive)},checkLangListShow:function(e){return e.hasClass(c.language.slice(1))&&!this._HAS_LANG_LIST},_bindEvent:function(){var i=this;s.menu.on("mouseenter",c.menuItem,function(){var e=a(this);if(i.checkLangListShow(e))return!1;i.isMobile||i.addMenuTimer(function(){i.hideMenuItems(e),e.addClass(c.menuItemActive)})}).on("mouseleave",c.menuItem,function(){var e=a(this);if(i.checkLangListShow(e))return!1;i.isMobile||i.addMenuTimer(function(){i.hideMenuItems()},200)}).on("click",c.menuItem,function(){var e=a(this);if(i.checkLangListShow(e))return!1;i.isMobile&&(e.hasClass(c.menuItemActive)?e.removeClass(c.menuItemActive):e.addClass(c.menuItemActive))}),s.toggleFull.on("click",c.toggleAccount,function(){var e=a(this);e.hasClass(c.listItemActive)?(e.removeClass(c.listItemActive),s.menu.removeClass(c.menuShowAccount)):(e.addClass(c.listItemActive).siblings().removeClass(c.listItemActive),s.menu.addClass(c.menuShowAccount),s.menu.removeClass(c.menuShowAll))}).on("click",c.toggleMenu,function(){var e=a(this);e.hasClass(c.listItemActive)?(e.removeClass(c.listItemActive),s.menu.removeClass(c.menuShowAll)):(e.addClass(c.listItemActive).siblings().removeClass(c.listItemActive),s.menu.removeClass(c.menuShowAccount),s.menu.addClass(c.menuShowAll))}),s.currencyList.on("click",c.listItem,function(){var e=a(this),t=e.data("currencyCode");e.hasClass(c.listItemActive)||(i.changeCurrency(t),e.parents(c.menuItem).removeClass(c.menuItemActive),e.addClass(c.listItemActive).siblings().removeClass(c.listItemActive))}).on("mousedown",c.listItem,function(){i.sendGAQ(a(this).data("currencyCode"))}),s.languageList.on("click",c.listItem,function(){var e=a(this),t=e.data("siteCode"),n=e.data("languageCode");e.hasClass(c.listItemActive)||(i.changeLanguage(t,n,e.text()),e.parents(c.menuItem).removeClass(c.menuItemActive).siblings().removeClass(c.listItemActive))}),s.accountList.on("click",c.listItem,function(){var e=a(this),t=e.data("type");if(e.parents(c.menuItem).removeClass(c.menuItemActive),i.trigger("account",t,e),cQuery.browser.isAllIE||d.getInstance({i18n:{loading:b}}).show(),"signin"==t){var n=e.attr("data-target");if(!S.page.header.pageMethodIsGet())return void S.page.header.changeSiteByPost(n,S.page.header.getParamFields());S.page.header.changeSiteByGet(n)}else"signout"==t&&(n=e.attr("data-target"),S.page.header.pageMethodIsGet()?S.page.header.changeSiteByGet(n):S.page.header.changeSiteByPost(n,S.page.header.getParamFields()))})},_unBindEvent:function(){},updateUnionCode:function(){try{if(r.__HEAD_CONFIG__&&r.__HEAD_CONFIG__._union_cookie&&1==r.__HEAD_CONFIG__._union_cookie)return;var e=g.get("AllianceID"),t=g.get("SID"),n=g.get("OUID");n||(n="");var i="";e&&t?i="/main/setenglishalliance/?allianceID="+encodeURIComponent(e)+"&siteID="+encodeURIComponent(t)+"&ouid="+encodeURIComponent(n)+"&from="+encodeURIComponent(document.referrer):document.referrer&&(i="/main/setenglishalliance/?from="+encodeURIComponent(document.referrer)+"&s="+encodeURIComponent(__SITE_CONFIG__.page.site)),0<i.length&&(a.jsonp("//"+__SITE_CONFIG__.domain.EN+i),a.jsonp("//"+__SITE_CONFIG__.domain.HK+i),a.jsonp("//"+__SITE_CONFIG__.domain.KR+i),a.jsonp("//"+__SITE_CONFIG__.domain.JP+i),a.jsonp("//"+__SITE_CONFIG__.domain.SG+i),a.jsonp("//"+__SITE_CONFIG__.domain.ID+i),a.jsonp("//"+__SITE_CONFIG__.domain.TH+i),a.jsonp("//"+__SITE_CONFIG__.domain.MY+i),a.jsonp("//"+__SITE_CONFIG__.domain.DE+i),a.jsonp("//"+__SITE_CONFIG__.domain.ES+i),a.jsonp("//"+__SITE_CONFIG__.domain.FR+i),a.jsonp("//"+__SITE_CONFIG__.domain.RU+i),a.jsonp("//www.trip.com"+i),a.jsonp("//hk.trip.com"+i),a.jsonp("//kr.trip.com"+i),a.jsonp("//jp.trip.com"+i),a.jsonp("//sg.trip.com"+i))}catch(o){}},cantonfair2016spring:function(){u.get(this.CANTON_FAIR_2016_SPRING)==this.CANTON_FAIR_2016_SPRING_VALUE&&(a(".nav-hotel").hide(),a(".nav-train").hide(),a(".nav-package").hide(),a(".nav-ttd").hide(),a(".nav-carrental").hide())},replaceDateStr:function(e){return e.replace(/\/Date\(/g,"\\/Date(").replace(/\)\/\"/g,')\\/"')},getParamFields:function(){var e=a(this.SITE_PARAM_FIELDS).value().trim();if(e.length)return e;if(L.formpara){var t=a.extend({},L.formpara);for(var n in t)t[n]=this.replaceDateStr(decodeURIComponent(t[n]))}return t&&a.tmpl.render(this._INPUT_TMPL,t)},getDomainBySiteCode:function(e){return L.domain[e]},changeSiteByGet:function(e){location.href=e},changeSiteByPost:function(e,t){var n=a(document.createElement("form"));a("body").append(n),n.append(this.createElem(t)),n.attr({method:"post",action:e}),n&&n.length&&n[0].submit()},_bindResize:function(){var e=this;a(r).resize(function(){e.checkIsMobile(),e.trigger("resize",e.isMobile),e.updateAccountState()})},isEasytrip:function(){return L&&L.page&&L.page.sitegroup&&"Easytrip"==L.page.sitegroup}},l),d=function(){function t(e){this.opts=a.extend({i18n:{loading:"Processing..."}},e),this.init()}return t.prototype={constructor:t,init:function(){var e=a("body");this.$el=this.createEl(a.tmpl.render('<div class="loading-item"><div class="loading-cnt"><div class="loading-brick"><i class="c-icon icon-loading-64"></i><div class="loading-txt">${loading}</div></div></div></div>',this.opts.i18n)),this.$mash=this.createEl('<div class="overlay-bg"></div>'),e.append(this.$mash),e.append(this.$el),this.hide()},getMaxIndex:function(){var t=0;return a("body *").each(function(e){t=Math.max(t,parseInt(e.css("zIndex"),10)||0)}),t},show:function(){var e=this,t=0;a.browser.isAllIE&&(t=300),this.timer&&(clearTimeout(this.timer),this.timer=null),this.timer=setTimeout(function(){e._show()},t)},_show:function(){var e=this.getMaxIndex();this.$el.css("zIndex",e+2).show(),this.$mash.css("zIndex",e+1).show()},hide:function(){this.$el.hide(),this.$mash.hide()},createEl:function(e){var t=document.createElement("div");return t.innerHTML=e,a(t).children()}},t.getInstance=function(e){return this.instance?this.instance:this.instance=new t(e||{i18n:{loading:b}})},t}(),f=e({_initFlag:!(o={}),ui:o,css:t={seo:".seo-box",footer:".footer-box",foldTit:".fold-tit",foldContainer:"fold-container",foldActive:"fold-active",expandCountryOrRegionSelector:".cur-lang"},init:function(){this._initFlag||(this.trigger("init:before"),this.getElements(),this.trigger("init",o),m.page.trigger("footer_init",o),this.bindEvent(),this._initFlag=!0,this.trigger("init:after",o))},initFooterState:function(){},getElements:function(){o.footer=a(t.footer),o.seo=a(t.seo)},bindEvent:function(){function e(){var e=a(this).parent();e.hasClass(t.foldContainer)&&(e.hasClass(t.foldActive)?e.removeClass(t.foldActive):e.addClass(t.foldActive))}o.seo.on("click",t.foldTit,e),o.footer.on("click",t.foldTit,e),o.footer.on("click",t.expandCountryOrRegionSelector,function(){a(this).parents(".ft-language").toggleClass("ft-language-active")})}},l),_=e({log:function(e,t,n){try{"undefined"==typeof r.__bfi&&(r.__bfi=[]),r.__bfi.push(["_tracklog",e,t,n])}catch(i){}},metric:function(e,t,n,i,o){n&&__SITE_CONFIG__&&__SITE_CONFIG__.page&&(n.ibu_language=__SITE_CONFIG__.page.language,n.ibu_site=__SITE_CONFIG__.page.site),"undefined"==typeof r.__bfi&&(r.__bfi=[]),r.__bfi.push(["_trackMetric",{name:e,value:t,tag:n,sample:i},o])}},l),p=!(m={ui:{PopLoading:d},siteConfig:L,cookie:u,param:g,events:l,page:e({method:L.page.method,isMobile:function(){return h.checkIsMobile()},isPost:function(){return h.pageMethodIsPost()},language:h.getPageLanguageCode(),getLanguage:function(){return h.getPageLanguageCode()},currency:h.getPageCurrencyCode(),getCurrency:function(){return h.getPageCurrencyCode()},getMethod:h.getPageMethod,isReady:function(){return p},isGet:function(){return h.pageMethodIsGet()},location:location.__proto__||location,header:h,cHeadFootInit:function(){if(r.__HEAD_CONFIG__&&r.head_foot_init)head_foot_init(),h.updateAccountURI(),h.updateUnionCode(),r.union_cookie_init&&union_cookie_init(),r.live_chat_init&&live_chat_init();else{if(p||!L.env)throw new Error("site config is empty, or cHeadFootInit is initialize!");m.page.trigger("ready"),p=!0,h.init(),f.init()}},footer:f,ubt:_},l)}),m);r.IBU=S,"function"==typeof define&&define.amd&&define.amd.jQuery&&define("cHeadFoot",["cQueryPro"],function(){return S});try{C={IBU:"1"},v={EN:"HotelAll",TC:"CANTONservice",JP:"HotelJP",KR:"HotelKR"},I={EN:"01",JP:"02",KR:"03",HK:"04"},A={EN:"01",JP:"02",KR:"03",TC:"04"},E={Invalide:"00",Main:"01",DomesticFlight:"02",IntlFlight:"03",DomesticHotel:"04",IntlHotel:"05",Train:"06"},k={Header:"1",SideBar:"2"},y={Version:"2.0",Platform:"1",Case:"-1",At:"2",WindowOpenFormat:"window.open('{0}')",ChatUrlFixedParam:"&version=2.0&platform=1&case=-1&at=2",ChatUrlOrderIdParam:"&orderid={0}",ChatUrlFormtDefault:"http://livechat.ctrip.com/livechat/login.aspx?groupcode={0}",ChatUrlFormat:"http://livechat.ctrip.com/livechat/login.aspx?groupcode={0}&origin={1}",ChatUrlFormatFat:"http://livechat.ctrip.fat531.qa.nt.ctripcorp.com/livechat/Chat.aspx?groupcode={0}&origin={1}"},(N=function(){}).prototype={constructor:N,init:function(){this._needHandle()&&(this._setChatUrl(),this._bindSideBarChatOn())},_bindSideBarChatOn:function(){var e=a("#mod_back_top");if(e||0!=e.length){var t=this,n="changeLiveChatUrl";e.bind("mouseover",function(){var e=a(this).find(".chat");t._checkIsChatControl(e)&&!e.attr(n)&&(e.attr("onclick",""),e.bind("click",function(){var e=t._getChatUrl(k.SideBar);t._execWindowOpen(e)}),e.attr(n,"1"))})}},_setChatUrl:function(){var e=a(".help-list li").last().find("a"),t=this;this._checkIsChatControl(e)&&(e.attr("onclick",""),e.bind("click",function(){var e=t._getChatUrl(k.Header);t._execWindowOpen(e)}))},_checkIsChatControl:function(e){return e&&0<e.length&&e.attr("onclick")&&-1<e.attr("onclick").toLowerCase().indexOf("livechat")},_getWindowOpenContent:function(e){return y.WindowOpenFormat.replace("{0}",e)},_execWindowOpen:function(e){r.open(e)},_getChatUrl:function(e){var t=this._getAllCode();if("0"==t)return y.ChatUrlFormtDefault.replace("{0}",v.EN);var n=t.orgin;n+=e;var i=t.groupCode,o=this._getChatUrlFormat().replace("{0}",i).replace("{1}",n);return o+=y.ChatUrlFixedParam},_getChatUrlFormat:function(){var e="",t=this._getPageConfig().URLConfig;e=t&&t.globalEnv&&"PRD"!=t.globalEnv.toUpperCase()?y.ChatUrlFormatFat:y.ChatUrlFormat;var n=this._getOrderId();return 0<n&&(e+=y.ChatUrlOrderIdParam.replace("{0}",n)),e},_getPageConfig:function(){return __PAGE_CONFIG__||{}},_getPageConfigBase:function(){return this._getPageConfig().base},_getAllCode:function(){var e=this._getPageConfigBase();if(!e)return"0";var t=e.domain,n=e.PageCode;if(!t||!n||"00"==n)return"0";var i=e.LanguageCode||e.languageCode,o=e.SiteCode,a=0!=e.IsDomesticPrd?1:0,r=this._getSiteCode(o),c=this._getLangCode(i),s=this._getProductCode(t,a);return{orgin:C.IBU+r+c+s+n,groupCode:this._getGroupCode(i)}},_getOrderId:function(){var e=a("#chat_order_id");return e&&0<e.length?e.value():0},_getGroupCode:function(e){var t=v.EN;if(!e)return t;switch(e.toUpperCase()){case"EN":t=v.EN;break;case"HK":t=v.TC;break;case"JP":t=v.JP;break;case"KR":t=v.KR}return t},_getSiteCode:function(e){var t=I.EN;if(!e)return t;switch(e.toUpperCase()){case"EN":t=I.EN;break;case"HK":t=I.HK;break;case"JP":t=I.JP;break;case"KR":t=I.KR}return t},_getLangCode:function(e){var t=A.EN;if(!e)return t;switch(e.toUpperCase()){case"EN":t=A.EN;break;case"HK":t=A.TC;break;case"JP":t=A.JP;break;case"KR":t=A.KR}return t},_getProductCode:function(e,t){var n=E.Invalide;switch(e.toLowerCase()){case"main":n=E.Main;break;case"flights":n=E.IntlFlight;break;case"chinaflights":n=E.DomesticFlight;break;case"hotels":n=t&&1==t?E.DomesticHotel:E.IntlHotel;break;case"trains":n=E.Train}return n},_needHandle:function(){if(r.__HEAD_CONFIG__&&r.__HEAD_CONFIG__._live_chat&&1==r.__HEAD_CONFIG__._live_chat)return!1;var e=this._getPageConfigBase();if(!e)return!1;var t=e.domain,n=e.PageCode;return!(!t||!n||"00"==n)}},(new N).init()}catch(P){}}(window,cQuery);